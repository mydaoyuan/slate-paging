{"version":3,"sources":["plugins/page/defaults.ts","plugins/page/normalizers/normalizePage.ts","plugins/page/withPage.ts","plugins/page-ui/PageElement.tsx","styledComponents.ts","newplugin.tsx","config/pluginOptions.ts","env.tsx","components/paging/input-div.tsx","components/paging/index.tsx","initData.js","App.tsx","plugins/page/createPagePlugin.ts","reportWebVitals.ts","index.tsx"],"names":["ELEMENT_PAGE","emptyPage","type","children","matchTag","dirtyNodes","Set","asyncPromise","Promise","resolve","isPageNormalize","setTimeRunClearn","timer","setTimeout","clear","heightWeakMap","WeakMap","computeRun","editor","pageNode","console","time","size","Array","from","shift","delete","pageElement","getDom","path","getPath","nextPagePath","nextPageNodeEntry","Editor","node","error","log","nextPageNode","hasNextPage","countPageHeight","pageHeight","getPageHeight","get","getElementChildHeight","isOverStep","overIndex","index","moveChildToNextPage","updateDirtyNode","createPageAndMove","set","empytHeiht","nextPageElement","nextPageChildren","preElementBottomMargin","length","computeItemHeight","childHeight","height","marginBottom","riseElementToPrevPage","concat","Transforms","removeNodes","at","timeEnd","then","has","add","element","ReactEditor","findPath","nodeElement","toDOMNode","PageNode","style","window","getComputedStyle","offsetHeight","parseFloat","paddingTop","paddingBottom","dom","mergeMargin","clientHeight","marginTop","mergeMarginVal","Math","max","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","splitIndex","formPath","toPath","nodePathIndex","moveNodes","match","n","isEditor","Element","isElement","includes","to","entryNode","wrapNodes","split","withPage","insertText","normalizeNode","entry","previous","prevNode","normalizePage","text","PageElement","attributes","nodeProps","className","FONT_COLOR","FONT_FAMILY","useStyledComponents","useMemo","components","createPlateComponents","ELEMENT_PARAGRAPH","withProps","StyledElement","styles","root","color","fontFamily","fontWeight","fontSize","lineHeight","margin","ELEMENT_TODO_LI","TodoListElement","textDecoration","opacity","ELEMENT_H1","textAlign","ELEMENT_H2","ELEMENT_TD","as","backgroundColor","border","padding","minWidth","selectors","ELEMENT_TABLE","TableElement","ELEMENT_TH","MARK_UNDERLINE","StyledLeaf","borderBottom","ELEMENT_ALIGN_RIGHT","ELEMENT_ALIGN_CENTER","ELEMENT_ALIGN_JUSTIFY","ELEMENT_ALIGN_LEFT","withPlaceholders","key","placeholder","hideOnBlur","ToolbarButtonsBasicElements","useStoreEditorRef","useEventEditorId","getPlatePluginType","icon","ToolbarButtonsList","ELEMENT_UL","ELEMENT_OL","ToolbarButtonsAlign","ToolbarButtonsBasicMarks","MARK_BOLD","MARK_ITALIC","MARK_STRIKETHROUGH","MARK_SUPERSCRIPT","MARK_SUBSCRIPT","ToolbarButtonsTable","transform","insertTable","deleteTable","addRow","deleteRow","addColumn","deleteColumn","BallonToolbarMarks","tooltip","arrow","delay","duration","hideOnClick","offset","placement","direction","hiddenDelay","theme","content","resetBlockTypesCommonRule","types","ELEMENT_BLOCKQUOTE","defaultType","optionsResetBlockTypePlugin","rules","hotkey","predicate","isBlockAboveEmpty","isSelectionAtBlockStart","optionsExitBreakPlugin","level","before","query","start","end","allow","KEYS_HEADING","optionsSoftBreakPlugin","ELEMENT_CODE_BLOCK","ConfigContext","React","createContext","pageInfo","state","page","headerValue","footerValue","headerAttribute","footerAttribute","PageContext","data","setPageData","setData","compile","require","compileOptions","escape","interpolate","InputDiv","props","value","changeValue","getCompileValue","useCallback","inputValue","compileValue","compileFn","replaceAll","useState","focus","setState","useEffect","autoFocus","onChange","e","target","onBlur","display","onClick","Paging","pageContext","useContext","arrs","fill","changeHeader","changeFooter","map","v","top","code","id","RichText","config","modelenv","eventBus","model","componentRef","useRef","handlePrint","useReactToPrint","current","removeAfterPrint","initialValuePasteHtml","initData","styledComponents","defaultOptions","createPlateOptions","pluginsMemo","plugins","createReactPlugin","createHistoryPlugin","createParagraphPlugin","createTodoListPlugin","createHeadingPlugin","createListPlugin","pluginKeys","renderElement","getRenderElement","withOverrides","createTablePlugin","createAlignPlugin","createBoldPlugin","createCodePlugin","createItalicPlugin","createHighlightPlugin","createUnderlinePlugin","createStrikethroughPlugin","createSubscriptPlugin","createSuperscriptPlugin","createKbdPlugin","createNodeIdPlugin","createResetNodePlugin","createSoftBreakPlugin","createExitBreakPlugin","createSelectOnBackspacePlugin","ELEMENT_IMAGE","push","createDeserializeHTMLPlugin","Provider","val","slateEditor","normalize","options","editableProps","width","minHeight","outline","initialValue","ref","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","App","document","getElementById"],"mappings":"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","file":"static/js/main.4d51b2e3.chunk.js","sourcesContent":["export const ELEMENT_PAGE = 'page'\n","import { Transforms, Element, Node, Editor, Path, NodeEntry } from 'slate'\nimport { ReactEditor } from 'slate-react'\nimport { SPEditor } from '@udecode/plate-core'\n\nconst emptyPage = {\n  type: 'page',\n  children: []\n}\n// 进行移动操作的匹配tag\nconst matchTag = ['h1', 'h2', 'p', 'ul', 'ol', 'table']\nconst dirtyNodes: Set<any> = new Set()\nlet asyncPromise = Promise.resolve()\nlet isPageNormalize = false\n\nconst setTimeRunClearn = (() => {\n  let timer: null | Number\n  return () => {\n    if (!timer) {\n      timer = setTimeout(() => {\n        isPageNormalize = false\n        dirtyNodes.clear()\n        timer = null\n      })\n    }\n  }\n})()\n\n// TODO 需要更加细粒度的存储。 存储 element 级别的高度  应该可以快一点的\nconst heightWeakMap = new WeakMap()\n\n// TODO\n/**\n * 如果当前只有一页，或者当前不存在page 元素，需要包裹一个 page 元素\n */\n\n/**\n * 在编辑器进行 normalize 的时候\n *  1、记录下当前 normalize 的 page 元素，为了防止分页修改，把上下页的 page 元素 也要记录下来\n *  2、normalize 完，react 操作 DOM 后就可以访问到 DOM 数据。 进行高度计算\n *    2.1、 为了能够在操作 DOM 再进行高度判断， 设置了个状态  isPageNormalize。\n *          isPageNormalize 用来判断是否是 DOM 高度分页造成的 normalize 触发，\n *          这种情况下就不需要再记录 page 元素了，否则会无限循环\n * 3、当前页面高度累加超出当前页面高度，则后续的元素都需要移动到下一页\n * 4、当前页面高度累加不足，且存在下页，则需要把下一页元素向上移动\n */\n\nexport const normalizePage = (editor: ReactEditor & SPEditor) => {\n  // can include custom normalisations---\n  const { normalizeNode } = editor\n  return (entry: any) => {\n    let [node, path] = entry\n    // if the node is Page\n    if (Element.isElement(node) && (node as any).type === 'page') {\n      if (!isPageNormalize && !dirtyNodes.size) {\n        // 等待操作了 DOM 后，进行计算 DOM 位置信息\n        asyncPromise.then(() => {\n          computeRun(editor)\n        })\n      }\n      if (!isPageNormalize) {\n        // 前一页要变脏，上一页是空的，下一页要补上\n        if (!dirtyNodes.size) {\n          const [prevNode] =\n            Editor.previous(editor, {\n              at: path\n            }) || []\n          if (prevNode) {\n            !dirtyNodes.has(prevNode) && dirtyNodes.add(prevNode)\n          }\n        }\n        !dirtyNodes.has(node) && dirtyNodes.add(node)\n      }\n      return\n    }\n\n    // Fall back to the original `normalizeNode` to enforce other constraints.\n    return normalizeNode(entry)\n  }\n}\n\nconst computeRun = (editor: any) => {\n  // console.log(dirtyNodes.size, 'dirtyNodesdirtyNodes 长度')\n  // 清除状态\n  setTimeRunClearn()\n  isPageNormalize = true\n  let pageNode: any\n  // 遍历page\n  console.time('while 循环')\n  while (dirtyNodes.size) {\n    const dirtyNodesArr = Array.from(dirtyNodes)\n    pageNode = dirtyNodesArr.shift()\n    dirtyNodes.delete(pageNode)\n    const pageElement = getDom(editor, pageNode)\n    const path = getPath(editor, pageNode)\n    if (!path || !pageElement) {\n      break\n    }\n    const nextPagePath = [path[0] + 1]\n    let nextPageNodeEntry: NodeEntry<Node> | undefined\n    try {\n      nextPageNodeEntry = Editor.node(editor, nextPagePath) // 还是要基于 slate 的数据结构\n    } catch (error) {\n      console.log(nextPagePath, '没有这个slate 节点，已经是最后一个节点了')\n    }\n    const nextPageNode: any = nextPageNodeEntry && nextPageNodeEntry[0]\n    const hasNextPage = !!nextPageNode // 还是要基于 slate 的数据结构\n    let countPageHeight = 0\n    // 进入高度计算\n    const pageHeight = getPageHeight(pageElement)\n    if (heightWeakMap.get(pageNode)) {\n      console.error('获取到了缓存')\n      countPageHeight = heightWeakMap.get(pageNode)\n    } else {\n      console.log('没有缓存')\n      const {\n        isOverStep,\n        index: overIndex,\n        countPageHeight: newCountPageHeight\n      } = getElementChildHeight(pageElement, countPageHeight, pageHeight)\n      countPageHeight = newCountPageHeight\n      if (isOverStep && overIndex) {\n        if (hasNextPage && nextPagePath) {\n          moveChildToNextPage(editor, overIndex, path, nextPagePath)\n          updateDirtyNode(editor, nextPagePath)\n          // 后续所有元素进行迁移，停止循环\n          break\n        } else {\n          createPageAndMove(editor, overIndex, path, pageNode)\n          // 后续所有元素进行迁移，停止循环\n          break\n        }\n      }\n      heightWeakMap.set(pageNode, countPageHeight)\n    }\n\n    const prevPageNeedFill =\n      countPageHeight < pageHeight &&\n      hasNextPage &&\n      nextPagePath &&\n      nextPageNode\n    // if current page have enough height can contain next page first child node,\n    //  we need move this node\n    if (prevPageNeedFill) {\n      // console.log('if current page have enough height can contain next')\n      let empytHeiht = pageHeight - countPageHeight\n      let nextPageElement = getDom(editor, nextPageNode)\n      if (!nextPageElement) {\n        break\n      }\n      const nextPageChildren = Array.from(nextPageElement.children)\n      // top bottom margin merge\n      let preElementBottomMargin = 0\n      for (let index = 0; index < nextPageChildren.length; index++) {\n        const nextPageChildNode = nextPageChildren[index]\n        const { height: childHeight, marginBottom } = computeItemHeight(\n          nextPageChildNode,\n          preElementBottomMargin\n        )\n        preElementBottomMargin = marginBottom\n        if (empytHeiht < childHeight) break\n        empytHeiht = empytHeiht - childHeight\n        const toPath = path.concat([pageNode.children.length])\n        // 提升当前的 DOM\n        debugger\n        riseElementToPrevPage(editor, index, nextPagePath, toPath)\n        // if move done, this page is empty, remove this page\n        if (index === nextPageChildren.length - 1) {\n          Transforms.removeNodes(editor, {\n            at: nextPagePath\n          })\n        }\n      }\n    }\n  }\n  console.timeEnd('while 循环')\n}\n\n/**\n * 添加需要计算的 Node\n * @param editor\n * @param path\n */\nfunction updateDirtyNode(editor: ReactEditor & SPEditor, path: any) {\n  Promise.resolve()\n    .then(() => {\n      let nextPageNodeEntry: NodeEntry<Node> | undefined\n      try {\n        nextPageNodeEntry = Editor.node(editor, path) // 还是要基于 slate 的数据结构\n      } catch (error) {\n        console.error(error)\n      }\n      const nextPageNode = nextPageNodeEntry && nextPageNodeEntry[0]\n      !dirtyNodes.has(nextPageNode) && dirtyNodes.add(nextPageNode)\n      return Promise.resolve()\n    })\n    .then(() => {\n      computeRun(editor)\n    })\n}\n\nfunction getElementChildHeight(\n  element: HTMLElement,\n  countPageHeight: number,\n  pageHeight: number\n) {\n  const children: globalThis.Element[] = Array.from(element.children)\n  // top bottom margin merge\n  let preElementBottomMargin = 0\n  for (let index = 0; index < children.length; index++) {\n    const child = children[index]\n    const { height: childHeight, marginBottom } = computeItemHeight(\n      child,\n      preElementBottomMargin\n    )\n    preElementBottomMargin = marginBottom\n    countPageHeight = countPageHeight + childHeight\n    if (countPageHeight > pageHeight) {\n      return { isOverStep: true, index, countPageHeight }\n    }\n  }\n  return { isOverStep: false, countPageHeight }\n}\n\n/**\n * trycatch 获取path\n * @param editor\n * @param node\n * @returns\n */\nfunction getPath(editor: ReactEditor & SPEditor, node: Node) {\n  let path\n  try {\n    path = ReactEditor.findPath(editor, node)\n  } catch (error) {\n    console.log(error)\n  }\n  return path\n}\n/**\n * try catch 获取 DOM\n * @param editor\n * @param node\n * @returns\n */\nfunction getDom(editor: ReactEditor & SPEditor, node: Node) {\n  let nodeElement\n  try {\n    nodeElement = ReactEditor.toDOMNode(editor, node)\n  } catch (error) {\n    console.error('DOM 转换失败', error)\n  }\n  return nodeElement\n}\n\n// 进入高度计算\nfunction getPageHeight(PageNode: HTMLElement) {\n  const style = window.getComputedStyle(PageNode)\n  const computedHeight = PageNode.offsetHeight\n  const padding =\n    parseFloat(style.paddingTop || '0') + parseFloat(style.paddingBottom || '0')\n\n  const pageHeight = computedHeight - padding\n  return pageHeight\n}\n\nfunction computeItemHeight(\n  dom: globalThis.Element,\n  mergeMargin: number\n): {\n  height: number\n  marginBottom: number\n} {\n  const style = window.getComputedStyle(dom)\n  const clientHeight = dom.clientHeight\n  const marginTop = parseFloat(style.marginBottom)\n  const mergeMarginVal = Math.max(marginTop - mergeMargin, 0)\n  const marginBottom = parseFloat(style.marginBottom)\n  const margin = mergeMarginVal + marginBottom\n  const padding = parseFloat(style.paddingBottom) + parseFloat(style.paddingTop)\n  const border =\n    parseFloat(style.borderLeftWidth) +\n    parseFloat(style.borderRightWidth) +\n    parseFloat(style.borderTopWidth) +\n    parseFloat(style.borderBottomWidth)\n\n  const height = clientHeight + margin + padding + border\n  return { height, marginBottom: marginBottom }\n}\n\nfunction moveChildToNextPage(\n  editor: ReactEditor,\n  splitIndex: number,\n  formPath: Path,\n  toPath: Path\n): void {\n  console.log('moveChildToNextPage')\n  let nodePathIndex = 0\n  Transforms.moveNodes(editor, {\n    at: formPath,\n    match(n) {\n      if (\n        !Editor.isEditor(n) &&\n        Element.isElement(n) &&\n        matchTag.includes((n as any).type)\n      ) {\n        return nodePathIndex++ >= splitIndex\n      }\n      return false\n    },\n    to: toPath.concat([0])\n  })\n}\n\nfunction createPageAndMove(\n  editor: ReactEditor,\n  splitIndex: number,\n  formPath: Path,\n  entryNode: Node\n) {\n  console.log('createPageAndMove')\n  // use index record nodes path, because node cant find path in this time.\n  let nodePathIndex = 0\n  // need create page node\n  Transforms.wrapNodes(editor, emptyPage, {\n    at: formPath,\n    split: true,\n    match(n) {\n      if (\n        !Editor.isEditor(n) &&\n        Element.isElement(n) &&\n        matchTag.includes((n as any).type)\n      ) {\n        // console.log((n as any).type, nodePathIndex, splitIndex)\n        return nodePathIndex++ >= splitIndex\n      }\n      return false\n    }\n  })\n  Transforms.moveNodes(editor, {\n    at: formPath,\n    match(n) {\n      if (\n        !Editor.isEditor(n) &&\n        Element.isElement(n) &&\n        (n as any).type === 'page' &&\n        n !== entryNode\n      ) {\n        return true\n      }\n      return false\n    },\n    to: [formPath[0] + 1]\n  })\n}\n\nfunction riseElementToPrevPage(\n  editor: ReactEditor,\n  splitIndex: number,\n  formPath: Path,\n  toPath: Path\n) {\n  console.log('riseElementToPrevPage')\n  Transforms.moveNodes(editor, {\n    at: formPath,\n    // eslint-disable-next-line space-before-function-paren\n    match(n) {\n      if (\n        !Editor.isEditor(n) &&\n        Element.isElement(n) &&\n        matchTag.includes((n as any).type) &&\n        (n as any).type !== 'page'\n      ) {\n        let path\n        try {\n          path = ReactEditor.findPath(editor, n)\n        } catch (error) {\n          return false\n        }\n        return path[1] <= splitIndex\n      }\n      return false\n    },\n    to: toPath // move to previous page last position\n  })\n}\n","import { SPEditor, WithOverride } from '@udecode/plate-core'\nimport { normalizePage } from './normalizers/normalizePage'\nimport { ReactEditor } from 'slate-react'\n\n// import { ELEMENT_LINE } from './defaults'\n\nexport const withPage =\n  (): WithOverride<ReactEditor & SPEditor> => (editor) => {\n    const { insertText } = editor\n    editor.normalizeNode = normalizePage(editor)\n    editor.insertText = (text) => {\n      console.log('insertText', text)\n      // debugger\n      insertText(text)\n    }\n    return editor\n  }\n","import * as React from 'react'\nimport { StyledElementProps } from '@udecode/plate-styled-components'\nimport './page.css'\nexport const PageElement = ({\n  attributes,\n  children,\n  nodeProps\n}: StyledElementProps) => {\n  return (\n    <div {...attributes} {...nodeProps} className='custom-page'>\n      {children}\n    </div>\n  )\n}\n","import { useMemo } from 'react'\nimport {\n  withPlaceholders,\n  createPlateComponents,\n  withProps,\n  // CodeBlockElement,\n  TableElement,\n  StyledElement,\n  TodoListElement,\n  StyledLeaf,\n  // ELEMENT_CODE_BLOCK,\n  ELEMENT_H1,\n  ELEMENT_H2,\n  ELEMENT_TD,\n  ELEMENT_TH,\n  ELEMENT_TABLE,\n  ELEMENT_TODO_LI,\n  ELEMENT_PARAGRAPH,\n  ELEMENT_ALIGN_RIGHT,\n  ELEMENT_ALIGN_CENTER,\n  ELEMENT_ALIGN_JUSTIFY,\n  ELEMENT_ALIGN_LEFT,\n  MARK_UNDERLINE\n} from '@udecode/plate'\n\nimport { ELEMENT_PAGE } from './plugins/page'\nimport { PageElement } from './plugins/page-ui'\n\nexport const withStyledPlaceHolders = (components: any) =>\n  withPlaceholders(components, [\n    {\n      key: ELEMENT_PARAGRAPH,\n      placeholder: '输入文字...',\n      hideOnBlur: true\n    }\n  ])\nconst FONT_COLOR = '#000'\nconst FONT_FAMILY = 'songti, \"SimSun\", STSong'\nconst useStyledComponents = () => {\n  return useMemo(() => {\n    return withStyledPlaceHolders(\n      createPlateComponents({\n        [ELEMENT_PAGE]: PageElement as any,\n        [ELEMENT_PARAGRAPH]: withProps(StyledElement, {\n          styles: {\n            root: {\n              color: FONT_COLOR,\n              fontFamily: FONT_FAMILY,\n              fontWeight: 600,\n              fontSize: '15.6px',\n              // fontSize: '18px',\n              lineHeight: '1.5',\n              margin: '0.33em 0'\n            }\n          }\n        }),\n        [ELEMENT_TODO_LI]: withProps(TodoListElement, {\n          styles: {\n            root: {\n              color: FONT_COLOR,\n              fontFamily: FONT_FAMILY,\n              fontWeight: 600,\n              fontSize: '15.6px',\n              lineHeight: '1.5'\n            },\n            text: {\n              textDecoration: 'none',\n              opacity: 1\n            }\n          }\n        }),\n        [ELEMENT_H1]: withProps(StyledElement, {\n          styles: {\n            root: {\n              color: FONT_COLOR,\n              fontFamily: FONT_FAMILY,\n              fontWeight: 600,\n              fontSize: '32px',\n              textAlign: 'center',\n              lineHeight: '1.4',\n              paddingBottom: '16px'\n            }\n          }\n        }),\n        [ELEMENT_H2]: withProps(StyledElement, {\n          styles: {\n            root: {\n              color: FONT_COLOR,\n              fontFamily: FONT_FAMILY,\n              fontWeight: 600,\n              fontSize: '18px',\n              textAlign: 'center',\n              lineHeight: '1.5'\n            }\n          }\n        }),\n        [ELEMENT_TD]: withProps(StyledElement, {\n          as: 'td',\n          styles: {\n            root: {\n              backgroundColor: '#fff',\n              color: FONT_COLOR,\n              fontFamily: FONT_FAMILY,\n              border: '1px solid #000',\n              padding: '3px 10px',\n              minWidth: '48px',\n              selectors: {\n                '> *': {\n                  margin: 0\n                }\n              }\n            }\n          }\n        }),\n        [ELEMENT_TABLE]: withProps(TableElement, {\n          styles: {\n            root: {\n              border: '2px solid #000'\n            }\n          }\n        }),\n        [ELEMENT_TH]: withProps(StyledElement, {\n          as: 'th',\n          styles: {\n            root: {\n              color: FONT_COLOR,\n              fontFamily: FONT_FAMILY,\n              backgroundColor: '#fff',\n              border: '1px solid #000',\n              padding: '3px 10px',\n              minWidth: '48px',\n              textAlign: 'left',\n              selectors: {\n                '> *': {\n                  margin: 0\n                }\n              }\n            }\n          }\n        }),\n        [MARK_UNDERLINE]: withProps(StyledLeaf, {\n          as: 'u',\n          styles: {\n            root: {\n              textDecoration: 'none',\n              // backgroundImage: 'linear-gradient(to top, currentColor, currentColor 0.1em, transparent 0.1em)',\n              borderBottom: '0.1em solid',\n              paddingBottom: '0.15em'\n            }\n          }\n        }),\n        [ELEMENT_ALIGN_RIGHT]: withProps(StyledElement, {\n          styles: {\n            root: {\n              textAlign: 'right !important',\n              selectors: {\n                '> *': {\n                  textAlign: 'right !important'\n                }\n              }\n            }\n          }\n        }),\n        [ELEMENT_ALIGN_CENTER]: withProps(StyledElement, {\n          styles: {\n            root: {\n              textAlign: 'center'\n            }\n          }\n        }),\n        [ELEMENT_ALIGN_JUSTIFY]: withProps(StyledElement, {\n          styles: {\n            root: {\n              textAlign: 'justify !important',\n              selectors: {\n                '> *': {\n                  textAlign: 'justify !important'\n                }\n              }\n            }\n          }\n        }),\n        [ELEMENT_ALIGN_LEFT]: withProps(StyledElement, {\n          styles: {\n            root: {\n              textAlign: 'left !important',\n              selectors: {\n                '> *': {\n                  textAlign: 'left !important'\n                }\n              }\n            }\n          }\n        })\n      })\n    )\n  }, [])\n}\n\nexport default useStyledComponents\n","/* eslint-disable */\nimport 'tippy.js/animations/scale.css'\nimport 'tippy.js/dist/tippy.css'\nimport React from 'react'\nimport { MoveHorizontal } from '@styled-icons/boxicons-regular/MoveHorizontal'\nimport { ListAlt } from '@styled-icons/material/ListAlt'\nimport { CheckBox } from '@styled-icons/material/CheckBox'\nimport { Highlight } from '@styled-icons/boxicons-regular/Highlight'\nimport { Subscript } from '@styled-icons/foundation/Subscript'\nimport { Superscript } from '@styled-icons/foundation/Superscript'\nimport { BorderAll } from '@styled-icons/material/BorderAll'\nimport { BorderBottom } from '@styled-icons/material/BorderBottom'\nimport { BorderClear } from '@styled-icons/material/BorderClear'\nimport { BorderLeft } from '@styled-icons/material/BorderLeft'\nimport { BorderRight } from '@styled-icons/material/BorderRight'\nimport { BorderTop } from '@styled-icons/material/BorderTop'\nimport { FormatAlignCenter } from '@styled-icons/material/FormatAlignCenter'\nimport { FormatAlignJustify } from '@styled-icons/material/FormatAlignJustify'\nimport { FormatAlignLeft } from '@styled-icons/material/FormatAlignLeft'\nimport { FormatAlignRight } from '@styled-icons/material/FormatAlignRight'\nimport { FormatBold } from '@styled-icons/material/FormatBold'\nimport { FormatItalic } from '@styled-icons/material/FormatItalic'\nimport { FormatListBulleted } from '@styled-icons/material/FormatListBulleted'\nimport { FormatListNumbered } from '@styled-icons/material/FormatListNumbered'\nimport { FormatQuote } from '@styled-icons/material/FormatQuote'\nimport { FormatStrikethrough } from '@styled-icons/material/FormatStrikethrough'\nimport { FormatUnderlined } from '@styled-icons/material/FormatUnderlined'\nimport { Keyboard } from '@styled-icons/material/Keyboard'\nimport { LooksOne } from '@styled-icons/material/LooksOne'\nimport { LooksTwo } from '@styled-icons/material/LooksTwo'\nimport { TippyProps } from '@tippyjs/react'\nimport {\n  addColumn,\n  addRow,\n  BalloonToolbar,\n  deleteColumn,\n  deleteRow,\n  deleteTable,\n  ELEMENT_ALIGN_LEFT,\n  ELEMENT_ALIGN_CENTER,\n  ELEMENT_ALIGN_JUSTIFY,\n  ELEMENT_ALIGN_RIGHT,\n  ELEMENT_BLOCKQUOTE,\n  ELEMENT_H1,\n  ELEMENT_H2,\n  ELEMENT_H3,\n  ELEMENT_H4,\n  ELEMENT_H5,\n  ELEMENT_H6,\n  ELEMENT_OL,\n  ELEMENT_UL,\n  getPlatePluginType,\n  insertTable,\n  MARK_BOLD,\n  MARK_CODE,\n  MARK_ITALIC,\n  MARK_KBD,\n  MARK_STRIKETHROUGH,\n  MARK_SUBSCRIPT,\n  MARK_SUPERSCRIPT,\n  MARK_UNDERLINE,\n  ToolbarAlign,\n  ToolbarElement,\n  ToolbarList,\n  ToolbarMark,\n  ToolbarTable\n} from '@udecode/plate'\nimport { ELEMENT_CODE_BLOCK } from '@udecode/plate-code-block'\nimport { ToolbarCodeBlock } from '@udecode/plate-code-block-ui'\nimport { useEventEditorId, useStoreEditorRef } from '@udecode/plate-core'\nimport { MARK_HIGHLIGHT } from '@udecode/plate-highlight'\n\nexport const ToolbarButtonsBasicElements = () => {\n  const editor = useStoreEditorRef(useEventEditorId('focus'))\n  console.log('i am run render ToolbarButtonsBasicElements')\n  return (\n    <>\n      <ToolbarElement\n        type={getPlatePluginType(editor, ELEMENT_H1)}\n        icon={<LooksOne />}\n      />\n      <ToolbarElement\n        type={getPlatePluginType(editor, ELEMENT_H2)}\n        icon={<LooksTwo />}\n      />\n\n      {/* <ToolbarElement type={getPlatePluginType(editor, ELEMENT_H3)} icon={<Looks3 />} />\n      <ToolbarElement type={getPlatePluginType(editor, ELEMENT_H4)} icon={<Looks4 />} />\n      <ToolbarElement type={getPlatePluginType(editor, ELEMENT_H5)} icon={<Looks5 />} />\n      <ToolbarElement type={getPlatePluginType(editor, ELEMENT_H6)} icon={<Looks6 />} /> */}\n      {/* <ToolbarElement type={getPlatePluginType(editor, ELEMENT_BLOCKQUOTE)} icon={<FormatQuote />} /> */}\n      {/* <ToolbarCodeBlock type={getPlatePluginType(editor, ELEMENT_CODE_BLOCK)} icon={<CodeBlock />} /> */}\n    </>\n  )\n}\n\nexport const ToolbarButtonsList = () => {\n  const editor = useStoreEditorRef(useEventEditorId('focus'))\n\n  return (\n    <>\n      <ToolbarList\n        type={getPlatePluginType(editor, ELEMENT_UL)}\n        icon={<FormatListBulleted />}\n      />\n      <ToolbarList\n        type={getPlatePluginType(editor, ELEMENT_OL)}\n        icon={<FormatListNumbered />}\n      />\n    </>\n  )\n}\n\nexport const ToolbarButtonsAlign = () => {\n  const editor = useStoreEditorRef(useEventEditorId('focus'))\n\n  return (\n    <>\n      <ToolbarAlign\n        type={getPlatePluginType(editor, ELEMENT_ALIGN_LEFT)}\n        icon={<FormatAlignLeft />}\n      />\n      <ToolbarAlign\n        type={getPlatePluginType(editor, ELEMENT_ALIGN_CENTER)}\n        icon={<FormatAlignCenter />}\n      />\n      <ToolbarAlign\n        type={getPlatePluginType(editor, ELEMENT_ALIGN_RIGHT)}\n        icon={<FormatAlignRight />}\n      />\n      <ToolbarAlign\n        type={getPlatePluginType(editor, ELEMENT_ALIGN_JUSTIFY)}\n        icon={<FormatAlignJustify />}\n      />\n    </>\n  )\n}\n\nexport const ToolbarButtonsBasicMarks = () => {\n  const editor = useStoreEditorRef(useEventEditorId('focus'))\n\n  return (\n    <>\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_BOLD)}\n        icon={<FormatBold />}\n      />\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_ITALIC)}\n        icon={<FormatItalic />}\n      />\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_UNDERLINE)}\n        icon={<FormatUnderlined />}\n      />\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_STRIKETHROUGH)}\n        icon={<FormatStrikethrough />}\n      />\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_SUPERSCRIPT)}\n        clear={getPlatePluginType(editor, MARK_SUBSCRIPT)}\n        icon={<Superscript />}\n      />\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_SUBSCRIPT)}\n        clear={getPlatePluginType(editor, MARK_SUPERSCRIPT)}\n        icon={<Subscript />}\n      />\n    </>\n  )\n}\n\nexport const ToolbarKbd = () => {\n  const editor = useStoreEditorRef(useEventEditorId('focus'))\n\n  return (\n    <ToolbarMark\n      type={getPlatePluginType(editor, MARK_KBD)}\n      icon={<Keyboard />}\n    />\n  )\n}\n\nexport const ToolbarHighlight = () => {\n  const editor = useStoreEditorRef(useEventEditorId('focus'))\n\n  return (\n    <ToolbarMark\n      type={getPlatePluginType(editor, MARK_HIGHLIGHT)}\n      icon={<Highlight />}\n    />\n  )\n}\n\nexport const ToolbarButtonsTable = () => (\n  <>\n    <ToolbarTable icon={<BorderAll />} transform={insertTable} />\n    <ToolbarTable icon={<BorderClear />} transform={deleteTable} />\n    <ToolbarTable icon={<BorderBottom />} transform={addRow} />\n    <ToolbarTable icon={<BorderTop />} transform={deleteRow} />\n    <ToolbarTable icon={<BorderLeft />} transform={addColumn} />\n    <ToolbarTable icon={<BorderRight />} transform={deleteColumn} />\n  </>\n)\n\nexport const BallonToolbarMarks = () => {\n  const editor = useStoreEditorRef(useEventEditorId('focus'))\n\n  const arrow = false\n  const theme = 'dark'\n  const direction = 'top'\n  const hiddenDelay = 0\n  const tooltip: TippyProps = {\n    arrow: true,\n    delay: 0,\n    duration: [200, 0],\n    hideOnClick: false,\n    offset: [0, 17],\n    placement: 'top'\n  }\n\n  return (\n    <BalloonToolbar\n      direction={direction}\n      hiddenDelay={hiddenDelay}\n      theme={theme}\n      arrow={arrow}\n    >\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_BOLD)}\n        icon={<FormatBold />}\n        tooltip={{ content: 'Bold (⌘B)', ...tooltip }}\n      />\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_ITALIC)}\n        icon={<FormatItalic />}\n        tooltip={{ content: 'Italic (⌘I)', ...tooltip }}\n      />\n      <ToolbarMark\n        type={getPlatePluginType(editor, MARK_UNDERLINE)}\n        icon={<FormatUnderlined />}\n        tooltip={{ content: 'Underline (⌘U)', ...tooltip }}\n      />\n    </BalloonToolbar>\n  )\n}\n","import {\n  ExitBreakPluginOptions,\n  ELEMENT_PARAGRAPH,\n  KEYS_HEADING,\n  ELEMENT_TD,\n  ELEMENT_BLOCKQUOTE,\n  ELEMENT_CODE_BLOCK,\n  ELEMENT_TODO_LI,\n  ResetBlockTypePluginOptions,\n  isBlockAboveEmpty,\n  isSelectionAtBlockStart,\n  SoftBreakPluginOptions\n} from '@udecode/plate'\n\nconst resetBlockTypesCommonRule = {\n  types: [ELEMENT_BLOCKQUOTE, ELEMENT_TODO_LI],\n  defaultType: ELEMENT_PARAGRAPH\n}\n\nexport const optionsResetBlockTypePlugin: ResetBlockTypePluginOptions = {\n  rules: [\n    {\n      ...resetBlockTypesCommonRule,\n      hotkey: 'Enter',\n      predicate: isBlockAboveEmpty\n    },\n    {\n      ...resetBlockTypesCommonRule,\n      hotkey: 'Backspace',\n      predicate: isSelectionAtBlockStart\n    }\n  ]\n}\n\nexport const optionsExitBreakPlugin: ExitBreakPluginOptions = {\n  rules: [\n    {\n      hotkey: 'mod+enter',\n      level: 1\n    },\n    {\n      hotkey: 'mod+shift+enter',\n      before: true,\n      level: 1\n    },\n    {\n      hotkey: 'enter',\n      query: {\n        start: true,\n        end: true,\n        allow: KEYS_HEADING\n      }\n    }\n  ]\n}\n\nexport const optionsSoftBreakPlugin: SoftBreakPluginOptions = {\n  rules: [\n    { hotkey: 'shift+enter' },\n    {\n      hotkey: 'enter',\n      query: {\n        allow: [ELEMENT_CODE_BLOCK, ELEMENT_BLOCKQUOTE, ELEMENT_TD]\n      }\n    }\n  ]\n}\n","import React, { useMemo, useState } from 'react'\n\ninterface Config {\n  model?: string\n  id?: string\n  value?: {}\n}\n\ninterface reactStyleAttr {\n  textAlign?: 'left' | 'right' | 'center'\n  color?: string\n}\ninterface PageInfo {\n  state: any\n  page: number\n  headerValue: string\n  footerValue: string\n  headerAttribute: reactStyleAttr\n  footerAttribute: reactStyleAttr\n}\n\nlet configValue: Config = {}\n\nexport const getConfigValue = () => {\n  return configValue\n}\nexport const setConfigValue = (val: Config) => {\n  configValue = val\n}\n\nexport const ConfigContext = React.createContext<Config>({})\n\n// 分页信息的\nconst pageInfo: PageInfo = {\n  state: {},\n  page: 1,\n  headerValue: '第{{page}}页 点击修改',\n  footerValue: '',\n  headerAttribute: {},\n  footerAttribute: {}\n}\n\nexport const PageContext = React.createContext<{\n  data: PageInfo\n  setPageData(val: PageInfo): any\n  setData: any\n}>({\n  data: pageInfo,\n  setPageData: () => {},\n  setData: () => {}\n})\n\nexport const PageProvider = (props: any) => {\n  const [data, setData] = useState<PageInfo>(pageInfo)\n\n  const providerValue = useMemo(() => {\n    return {\n      data,\n      setData: (val: any) => {\n        console.log(val, '编辑器的数据')\n        // page 是顶级元素，只要进行一层遍历\n        let page = 0\n        for (let index = 0; index < val.length; index++) {\n          const element = val[index]\n          if (element.type === 'page') {\n            page += 1\n          }\n        }\n        // 计算page\n        const pageInfo = {\n          ...data,\n          page: page\n        }\n        setData(pageInfo)\n      },\n      setPageData(state: PageInfo) {\n        setData(state)\n      }\n    }\n  }, [data, setData])\n\n  return (\n    <PageContext.Provider value={providerValue}>\n      {props.children}\n    </PageContext.Provider>\n  )\n}\n","import React, { useState } from 'react'\nimport { useCallback } from 'react'\nimport { useEffect } from 'react'\nconst compile = require('lodash.template')\nconst compileOptions = {\n  escape: /{{([^{][\\s\\S]+?[^}])}}/g,\n  interpolate: /{{{([\\s\\S]+?)}}}/g\n}\n// 优化 回车后跳回编辑器\n\nexport default function InputDiv(props: any) {\n  const { value, changeValue, className = '', placeholder, style, page } = props\n  const getCompileValue = useCallback(\n    (inputValue: string) => {\n      let compileValue = ''\n      try {\n        const compileFn = compile(inputValue, compileOptions)\n        const val = compileFn({\n          page\n        })\n        compileValue = val\n      } catch (error) {\n        console.log(' 无效  变量 呀兄弟 is value  compile')\n        compileValue = '无效表达式'\n      }\n      compileValue = compileValue.replaceAll(' ', '\\u00a0')\n      return compileValue\n    },\n    [page]\n  )\n\n  const [state, setState] = useState({\n    focus: false,\n    compileValue: getCompileValue(value)\n  })\n\n  const onBlur = () => {\n    setState({\n      ...state,\n      focus: false,\n      compileValue: getCompileValue(value)\n    })\n  }\n\n  useEffect(() => {\n    const compileValue = getCompileValue(value)\n    setState((state) => {\n      state.compileValue = compileValue\n      return state\n    })\n  }, [value, getCompileValue])\n\n  const changeHeader = (e: React.ChangeEvent<HTMLInputElement>) => {\n    console.log('changeHeader')\n    changeValue(e.target.value)\n  }\n  const onclick = () => {\n    setState({\n      ...state,\n      focus: true\n    })\n  }\n\n  return (\n    <div\n      className={\n        state.focus\n          ? `${className} page-input-warp active`\n          : `${className} page-input-warp`\n      }\n      style={style || {}}\n    >\n      {state.focus ? (\n        <input\n          className='page-input'\n          value={value}\n          autoFocus\n          onChange={changeHeader}\n          onBlur={onBlur}\n          type='text'\n        />\n      ) : null}\n      <div\n        className='page-content'\n        style={{\n          display: state.focus ? 'none' : 'block',\n          fontSize: '14px'\n        }}\n        onClick={onclick}\n      >\n        {state.compileValue || placeholder}\n      </div>\n    </div>\n  )\n}\n","import React, { useContext, useState } from 'react'\nimport { PageContext } from '../../env'\nimport InputDiv from './input-div'\n\nexport default function Paging(props: any) {\n  const pageContext = useContext(PageContext)\n  const data = pageContext.data\n  const arrs = new Array(data.page).fill('')\n  // 一页的高度  用于计算位置\n  const pageHeight = 1122\n  // const pageToolHeight = 0\n  const pageToolHeight = 60\n  const selfHeight = 44\n  const changeHeader = (e: string) => {\n    pageContext.setPageData({ ...data, headerValue: e })\n  }\n  const changeFooter = (e: string) => {\n    pageContext.setPageData({ ...data, footerValue: e })\n  }\n\n  return (\n    <div className='paging-com'>\n      {arrs.map((v, index) => {\n        return (\n          <div key={'page-warp' + index}>\n            <InputDiv\n              style={{\n                top: index * pageHeight + pageToolHeight + 'px'\n              }}\n              changeValue={changeHeader}\n              page={index + 1}\n              value={data.headerValue}\n              placeholder={'点击输入页眉'}\n            ></InputDiv>\n            <InputDiv\n              style={{\n                top:\n                  (index + 1) * pageHeight + pageToolHeight - selfHeight + 'px'\n              }}\n              changeValue={changeFooter}\n              page={index + 1}\n              value={data.footerValue}\n              placeholder={'点击输入页脚'}\n            ></InputDiv>\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n","export default [\n  {\n    type: 'page',\n    children: [\n      { type: 'h1', children: [{ text: '🍪 Deserialize HTML' }] },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        children: [\n          {\n            text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      { type: 'p', id: 1632885175785, children: [{ text: '' }] }\n    ]\n  },\n  {\n    type: 'page',\n    children: [\n      { type: 'p', id: 1632885176322, children: [{ text: '2' }] },\n      {\n        type: 'p',\n        id: 1632885177381,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885177906,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885178407,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885178798,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885179212,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885179628,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885180103,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885180501,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885180937,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885181373,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      { type: 'p', id: 1632885181979, children: [{ text: '' }] },\n      {\n        type: 'p',\n        id: 1632885182254,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      {\n        type: 'p',\n        id: 1632885183211,\n        children: [\n          { text: 'handle ' },\n          { text: \"'text/html'\", code: true },\n          {\n            text: \" data. By default, pasting content into a Slate editor will use the clipboard's \"\n          },\n          { text: \"'text/plain'\", code: true },\n          {\n            text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n          },\n          { text: \"'text/html'\", code: true },\n          { text: ' data. ' }\n        ]\n      },\n      { type: 'p', id: 1632885184229, children: [{ text: '' }] },\n      { type: 'p', id: 1632885184742, children: [{ text: '3' }] }\n    ],\n    id: 1632885176399\n  }\n]\n","/* eslint-disable no-console */\nimport React, { useEffect, useMemo, useState, useRef, useContext } from 'react'\nimport {\n  Plate,\n  createReactPlugin,\n  createHistoryPlugin,\n  createParagraphPlugin,\n  // createBlockquotePlugin,\n  createItalicPlugin,\n  createStrikethroughPlugin,\n  createCodePlugin,\n  createUnderlinePlugin,\n  createBoldPlugin,\n  createTablePlugin,\n  createSuperscriptPlugin,\n  createHighlightPlugin,\n  createSubscriptPlugin,\n  createTodoListPlugin,\n  createKbdPlugin,\n  // createNormalizeTypesPlugin,\n  // createTrailingBlockPlugin,\n  createSelectOnBackspacePlugin,\n  createDeserializeHTMLPlugin,\n  createAlignPlugin,\n  createExitBreakPlugin,\n  ExitBreakPluginOptions,\n  createNodeIdPlugin,\n  createListPlugin,\n  createHeadingPlugin,\n  // createCodeBlockPlugin,\n  ELEMENT_PARAGRAPH,\n  // ELEMENT_H1,\n  KEYS_HEADING,\n  // ELEMENT_H2,\n  ELEMENT_TD,\n  ELEMENT_IMAGE,\n  ELEMENT_BLOCKQUOTE,\n  ELEMENT_CODE_BLOCK,\n  // ELEMENT_CODE_LINE,\n  ELEMENT_TODO_LI,\n  // CodeBlockElement,\n  // 搜索插件\n  // useFindReplacePlugin,\n  // MARK_BOLD,\n  // withPlaceholders,\n  createPlateOptions,\n  // createSlatePluginsComponents,\n  // withProps,\n  ResetBlockTypePluginOptions,\n  isBlockAboveEmpty,\n  isSelectionAtBlockStart,\n  createResetNodePlugin,\n  createSoftBreakPlugin,\n  SoftBreakPluginOptions\n  // createAutoformatPlugin,\n  // useStoreState\n} from '@udecode/plate'\nimport { useStoreEditorRef, useEventEditorStore } from '@udecode/plate-core'\nimport { useReactToPrint } from 'react-to-print'\nimport { ReactEditor } from 'slate-react'\nimport { Transforms, Editor as slateEditor } from 'slate'\nimport useStyledComponents from './styledComponents'\nimport { HeadingToolbar } from '@udecode/plate-toolbar'\nimport {\n  ToolbarButtonsBasicElements,\n  BallonToolbarMarks,\n  ToolbarButtonsAlign,\n  ToolbarButtonsTable,\n  ToolbarButtonsList,\n  ToolbarButtonsBasicMarks\n} from './newplugin'\n\n// markdown语法支持\n// import { optionsAutoformat } from './autoformatRules'\n// import DominInput from './components/domin/input'\n\nimport {\n  optionsResetBlockTypePlugin,\n  optionsExitBreakPlugin,\n  optionsSoftBreakPlugin\n} from './config/pluginOptions'\nimport { ConfigContext, PageContext, PageProvider } from './env'\nimport { createPagePlugin } from './plugins/page'\nimport Paging from './components/paging/index'\nimport initData from './initData'\nconst RichText = ({ config, eventBus }: any) => {\n  const { model: modelenv, id } = config\n  const componentRef = useRef(null)\n  const handlePrint = useReactToPrint({\n    content: () => componentRef.current,\n    removeAfterPrint: false\n  })\n\n  useEffect(() => {\n    ;(window as any).handlePrint = handlePrint\n  }, [handlePrint])\n\n  // const initialValueBasicElements = config.value || [\n  //   { type: 'p', children: [{ text: '' }] }\n  // ]\n  // const initialValuePasteHtml: any = [\n  //   {\n  //     type: 'page',\n  //     children: [\n  //       {\n  //         type: 'h1',\n  //         children: [\n  //           {\n  //             text: '🍪 Deserialize HTML'\n  //           }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       },\n  //       {\n  //         type: 'p',\n  //         children: [\n  //           {\n  //             text: \"By default, pasting content into a Slate editor will use the clipboard's \"\n  //           },\n  //           { text: \"'text/plain'\", code: true },\n  //           {\n  //             text: \" data. That's okay for some use cases, but sometimes you want users to be able to paste in content and have it maintain its formatting. To do this, your editor needs to handle \"\n  //           },\n  //           { text: \"'text/html'\", code: true },\n  //           { text: ' data. ' }\n  //         ]\n  //       }\n  //     ]\n  //   }\n  // ]\n  const initialValuePasteHtml: any = initData\n  const styledComponents = useStyledComponents()\n\n  const defaultOptions = createPlateOptions()\n\n  // const Tootip = useMemo(() => {\n  //   return modelenv === 'read' ? null : <BallonToolbarMarks />\n  // }, [modelenv])\n\n  const Editor = () => {\n    const pluginsMemo = useMemo(() => {\n      const plugins = [\n        createReactPlugin(),\n        createHistoryPlugin(),\n        createParagraphPlugin(),\n        // createBlockquotePlugin(),\n        createTodoListPlugin(),\n        createHeadingPlugin(),\n        createListPlugin(),\n        createPagePlugin(),\n        createTablePlugin(),\n        // createCodeBlockPlugin(),\n        createAlignPlugin(),\n        createBoldPlugin(),\n        createCodePlugin(),\n        createItalicPlugin(),\n        createHighlightPlugin(),\n        createUnderlinePlugin(),\n        createStrikethroughPlugin(),\n        createSubscriptPlugin(),\n        createSuperscriptPlugin(),\n        // 键盘监听\n        createKbdPlugin(),\n        createNodeIdPlugin(),\n        // markdown语法支持\n        // createAutoformatPlugin(optionsAutoformat),\n        // 设置默认模块\n        createResetNodePlugin(optionsResetBlockTypePlugin),\n        // 软换行\n        createSoftBreakPlugin(optionsSoftBreakPlugin),\n        // 退出当前块\n        createExitBreakPlugin(optionsExitBreakPlugin),\n        // 强制布局\n        // createNormalizeTypesPlugin({\n        //   rules: [{ path: [0, 0], strictType: ELEMENT_H1 }],\n        // }),\n        // createTrailingBlockPlugin({\n        //   type: ELEMENT_PARAGRAPH,\n        //   level: 1,\n        // }),\n        createSelectOnBackspacePlugin({ allow: ELEMENT_IMAGE })\n      ]\n      // 处理html文本插入\n      plugins.push(createDeserializeHTMLPlugin({ plugins }))\n\n      return plugins\n    }, [])\n    const pageContext = useContext(PageContext)\n    const editor = useStoreEditorRef()\n    let [value, setValue] = useState<any>(initialValuePasteHtml)\n    const editableProps = {\n      // placeholder: 'Type…',\n      style: {\n        width: '794px',\n        minHeight: '500px',\n        outline: '1px solid rgb(238, 238, 238)'\n      }\n    }\n    return (\n      <ConfigContext.Provider value={config}>\n        <Plate\n          id={id}\n          plugins={pluginsMemo}\n          onChange={(val) => {\n            console.log(val)\n            editor && slateEditor.normalize(editor)\n            pageContext.setData(val)\n            // setValue(val)\n            // pubInstance.publish('update', val)\n          }}\n          components={styledComponents}\n          options={defaultOptions}\n          editableProps={editableProps}\n          initialValue={value}\n        >\n          <HeadingToolbar styles={{ root: { margin: '0px -20px 0' } }}>\n            <ToolbarButtonsBasicElements />\n            <ToolbarButtonsList />\n            <ToolbarButtonsBasicMarks />\n            <ToolbarButtonsAlign />\n            <ToolbarButtonsTable />\n          </HeadingToolbar>\n          <BallonToolbarMarks></BallonToolbarMarks>\n          <Paging></Paging>\n        </Plate>\n      </ConfigContext.Provider>\n    )\n  }\n\n  return (\n    <div\n      ref={componentRef}\n      className={\n        modelenv === 'read'\n          ? 'readmodel-editor slate-editor-core'\n          : 'slate-editor-core'\n      }\n    >\n      {/* <PageProvider> */}\n      <Editor />\n      {/* </PageProvider> */}\n    </div>\n  )\n}\n\nexport default RichText\n","import { getRenderElement, PlatePlugin } from '@udecode/plate-core'\nimport { ELEMENT_PAGE } from './defaults'\nimport { withPage } from './withPage'\n\n/**\n * Enables support for hyperlinks.\n */\nexport const createPagePlugin = (): PlatePlugin => ({\n  pluginKeys: ELEMENT_PAGE,\n  renderElement: getRenderElement(ELEMENT_PAGE),\n  withOverrides: withPage()\n})\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App config={{ model: 'desc', id: 'udos' }} />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}